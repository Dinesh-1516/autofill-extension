import{g as uo,B as ho,h as yo}from"../../assets/react-toastify.esm-zXEqVuLq.js";const _o=void 0;var ve;(e=>{let o=!1;const t=[];chrome.runtime.onMessage.addListener(r=>{r.action==="stop_linkedin_fetch"&&r.stopFetch&&(o=!0,console.log("Fetching has been stopped."))});async function s(r,i){if(!o){console.log(r),console.log("main_linkedin_url",i);try{if(i&&i.length>1){const n=await uo("https://www.linkedin.com","JSESSIONID");if(n&&typeof n=="string"){const f=n.replace(/"/g,"");console.log("Cookie fetched successfully:",f);let l=`${i}${r}`;console.log("headers_API_DATA",{token:f,linkedinAPI:l});const g=await fetch(l,{method:"GET",headers:{"csrf-token":f,accept:"application/vnd.linkedin.normalized+json+2.1"}});if(!g.ok)throw new Error(`Error fetching data: ${g.statusText}`);const d=await g.json();u(d)}else console.error("Invalid or missing JSESSIONID cookie")}else console.error("Invalid LinkedIn URL")}catch(n){console.error("Failed to fetch job data:",n)}}}e.fetchLinkedInJobData=s;function u(r){const i=(r.included??[]).map(f=>{var g;console.log("Itrateditem",f);const l=f.elements[8].jobCardUnion.jobPostingCard.jobPostingUrn;return l?(g=l.match(/\d+/))==null?void 0:g[0]:null}).filter(Boolean),n=[];return n.push(...new Set(i)),console.log("Collected URNs so far:",new Set(n)),n}e.processJobPostings=u;async function a(r){console.log(`Starting job details fetch for ${r.length} URNs`);try{const i=r.map(n=>`urn%3Ali%3Afsd_jobPostingCard%3A%28${n}%2CJOB_DETAILS%29`).join(",");await h(i),chrome.runtime.sendMessage({action:"progress_bar_linkedin",current_urn:r.length,total_urn:r.length})}catch(i){console.error("Error fetching job details:",i)}console.log("All job details have been fetched!")}e.fetchJobDetails=a;async function h(r){const i=`https://www.linkedin.com/voyager/api/graphql?variables=(jobPostingDetailDescription_start:0,jobPostingDetailDescription_count:5,jobCardPrefetchQuery:(jobUseCase:JOB_DETAILS,prefetchJobPostingCardUrns:List(${r}),count:5),jobDetailsContext:(isJobSearch:true))&queryId=voyagerJobsDashJobCards.174f05382121bd73f2f133da2e4af893`,n=await uo("https://www.linkedin.com","JSESSIONID");if(n&&typeof n=="string"){const f=n.replace(/"/g,"");console.log("Cookie fetched successfully:",f);const g=await fetch(i,{method:"GET",headers:{"x-restli-protocol-version":"2.0.0",accept:"application/json","csrf-token":f}});if(!g.ok)throw new Error("Error fetching job details");const d=await g.json(),y=p(d);console.log("POST_DATA FOR Linkedin Jobs in popup",y),vo("LINKEDIN",y)}}function p(r){var i,n;return console.log("jdData_new",r),[{Job_title:((n=(i=r.included)==null?void 0:i[3])==null?void 0:n.title)||"N/A"}]}async function c(r,i,n){console.log("fetchAndProcessInBatches_url",n);let f="";n.length>1?(f=wo(n),console.log("linkedinUrlData url available",f)):console.log("URL Not available");const l=25;for(let g=r;g<=i&&!o;g++){const d=(g-1)*l;await s(d,f),console.log(`Completed fetching and processing for batch ${g}`)}console.log("All specified batches have been processed!"),console.log("Final collected URNs:",t),t.length>0&&a(t)}e.fetchAndProcessInBatches=c})(ve||(ve={}));const wo=e=>{const o=new URL(e),t={origin:o.searchParams.get("origin"),keywords:o.searchParams.get("keywords"),geoId:o.searchParams.get("geoId"),currentJobId:o.searchParams.get("currentJobId"),experience_level:o.searchParams.get("f_E"),datePosted:o.searchParams.get("f_TPR"),salary:o.searchParams.get("f_SB2"),company_name:o.searchParams.get("f_C"),job_type:o.searchParams.get("f_WT"),easy_apply:o.searchParams.get("f_AL"),sort_by:o.searchParams.get("sortBy"),distance:o.searchParams.get("distance")},s=[`origin:${t.origin||""}`,`keywords:${t.keywords||""}`,t.geoId?`locationUnion:(geoId:${t.geoId})`:""].filter(Boolean).join(","),u=[t.distance?`distance:List(${t.distance})`:"",t.experience_level?`experience:List(${t.experience_level})`:"",t.datePosted?`timePostedRange:List(${t.datePosted})`:"",t.salary?`salaryBucketV2:List(${t.salary})`:"",t.company_name?`company:List(${t.company_name})`:"",t.job_type?`workplaceType:List(${t.job_type})`:"",t.easy_apply?`applyWithLinkedin:List(${t.easy_apply})`:"",t.sort_by?`sortBy:List(${t.sort_by})`:""].filter(Boolean),a=u.length>0?`,selectedFilters:(${u.join(",")})`:"",p=`https://www.linkedin.com/voyager/api/voyagerJobsDashJobCards?decorationId=com.linkedin.voyager.dash.deco.jobs.search.JobSearchCardsCollection-215&count=25&q=jobSearch&query=${`(${s}${a},spellCorrectionEnabled:true)`}&start=`;return console.log("Constructed API URL:",p),p};async function vo(e,o){const t=`${_o}v1/jds:extension?provider=${e}`;try{const s=await fetch(t,{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify([{details:o,provider:e}])});if(!s.ok)throw new Error(`Error: ${s.status} ${s.statusText}`);const u=await s.json();return console.log("API_Response:",u),s.metadata.message==="OK"&&ho.success("Job added successfully"),u}catch(s){throw console.error("Error posting job details:",s),s}}const I=[];for(let e=0;e<256;++e)I.push((e+256).toString(16).slice(1));function bo(e,o=0){return(I[e[o+0]]+I[e[o+1]]+I[e[o+2]]+I[e[o+3]]+"-"+I[e[o+4]]+I[e[o+5]]+"-"+I[e[o+6]]+I[e[o+7]]+"-"+I[e[o+8]]+I[e[o+9]]+"-"+I[e[o+10]]+I[e[o+11]]+I[e[o+12]]+I[e[o+13]]+I[e[o+14]]+I[e[o+15]]).toLowerCase()}let we;const ko=new Uint8Array(16);function Io(){if(!we){if(typeof crypto>"u"||!crypto.getRandomValues)throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");we=crypto.getRandomValues.bind(crypto)}return we(ko)}const Uo=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),po={randomUUID:Uo};function To(e,o,t){var u;e=e||{};const s=e.random??((u=e.rng)==null?void 0:u.call(e))??Io();if(s.length<16)throw new Error("Random bytes length must be >= 16");return s[6]=s[6]&15|64,s[8]=s[8]&63|128,bo(s)}function So(e,o,t){return po.randomUUID&&!o&&!e?po.randomUUID():To(e)}async function _e(e,o){return new Promise(t=>{chrome.cookies.get({url:e,name:o},s=>{t(s)})})}async function Po(){console.log("getLatestFirebaseToken invoked");const e=["https://hire10x.10xscale.ai/*"];for(const o of e){const t=await _e(o,"firebase_id_token");if(t!=null&&t.value)return console.log(`Found token in domain: ${o}`),t.value}return console.log("No firebase_id_token found in any domain"),null}const Ao=async(e,o,t)=>{var n,f;const s=e.split("in/")[1].split("/")[0],u=`https://www.linkedin.com/voyager/api/identity/dash/profiles?decorationId=com.linkedin.voyager.dash.deco.identity.profile.WebTopCardCore-9&memberIdentity=${s}&q=memberIdentity`,a=await fetch(u,{method:"GET",headers:{"csrf-token":t}});if(!a.ok)throw new Error(`Failed to fetch profile data. Status: ${a.status}`);const h=await a.json(),p=(f=(n=h==null?void 0:h.elements)==null?void 0:n[0])==null?void 0:f.entityUrn;if(!p)throw new Error(`Could not extract profile URN for ${s}.`);const i=await fetch("https://www.linkedin.com/voyager/api/voyagerRelationshipsDashMemberRelationships?action=verifyQuotaAndCreate",{method:"POST",headers:{"csrf-token":t,"Content-Type":"application/json"},body:JSON.stringify({inviteeProfileUrn:p,customMessage:o})});if(!i.ok){const l=await i.json();throw new Error(`Connection request failed: ${(l==null?void 0:l.message)||"Unknown error"}`)}return`Successfully sent connect request to ${s}.`},Eo=()=>new Promise((e,o)=>{chrome.cookies.get({url:"https://www.linkedin.com",name:"JSESSIONID"},t=>{t&&t.value?e(t.value.replace(/"/g,"")):o(new Error("LinkedIn CSRF token (JSESSIONID cookie) not found. Are you logged in?"))})}),be="http://103.173.214.116/user-service",Co="http://dev.10xscale.ai/jd-cv-service",ke="4689008018943119360-STUDENT",Ie="4689008018943119360",Ue="STUDENT",Te="4689008018943119360";async function Do(e){try{console.log("üìÑ Fetching resume public URL..."),console.log("Cloud path:",e);const o=await fetch(`${Co}/v1/generate/public-url?cloud_path=${encodeURIComponent(e)}`,{method:"GET",headers:{accept:"application/json"}});if(!o.ok)return console.error(`‚ùå Resume API Error: ${o.status} - ${o.statusText}`),null;const t=await o.json();return console.log("‚úÖ Resume public URL fetched successfully"),t.data}catch(o){return console.error("‚ùå Error fetching resume public URL:",o),null}}async function No(e){try{console.log("üì• Downloading resume from public URL...");const o=await fetch(e);if(!o.ok)return console.error(`‚ùå Resume download error: ${o.status}`),null;const t=await o.blob();return new Promise((s,u)=>{const a=new FileReader;a.onloadend=()=>{const p=a.result.split(",")[1];console.log("‚úÖ Resume downloaded and converted to base64"),console.log("Resume size:",t.size,"bytes"),s(p)},a.onerror=()=>{console.error("‚ùå Error converting resume to base64"),u(new Error("Failed to convert resume to base64"))},a.readAsDataURL(t)})}catch(o){return console.error("‚ùå Error downloading resume:",o),null}}async function Se(){var e,o,t,s,u,a,h;try{console.log("üîÑ Fetching user details from API..."),console.log("API URL:",`${be}/v1/users/${Te}`),console.log("Request Headers:",{"x-signature":ke,"x-user-id":Ie,"x-user-role":Ue,"Content-Type":"application/json"});const p=await fetch(`${be}/v1/users/${Te}`,{method:"GET",headers:{"x-signature":ke,"x-user-id":Ie,"x-user-role":Ue,"Content-Type":"application/json"}});if(console.log("Response Status:",p.status,p.statusText),!p.ok){console.error(`‚ùå API Error: ${p.status} - ${p.statusText}`);try{const r=await p.text();console.error("Error response body:",r)}catch{console.error("Could not parse error response")}return null}const c=await p.json();if(console.log("‚úÖ User details fetched successfully"),console.log("API Response:",{metadata:c.metadata,data:{...c.data,image:(e=c.data)!=null&&e.image?"[Image data]":void 0,resume:(o=c.data)!=null&&o.resume?c.data.resume:void 0,extra_links:(t=c.data)!=null&&t.extra_links?"[Extra links]":void 0,meta:(s=c.data)!=null&&s.meta?"[Metadata]":void 0,educations:(u=c.data)!=null&&u.educations?`[${c.data.educations.length} education entries]`:void 0,experiences:(a=c.data)!=null&&a.experiences?`[${c.data.experiences.length} experience entries]`:void 0}}),c.data){const{id:r,email:i,full_name:n,first_name:f,last_name:l,phone:g}=c.data;console.log("User Info:",{id:r,email:i,full_name:n,first_name:f,last_name:l,phone:g})}if((h=c.data)!=null&&h.resume){console.log("üìÑ Resume path found:",c.data.resume);const r=await Do(c.data.resume);if(r){console.log("‚úÖ Public URL obtained:",r.substring(0,100)+"...");const i=await No(r);i?(await chrome.storage.local.set({resumeBase64:i,resumePath:c.data.resume}),console.log("‚úÖ Resume downloaded and stored in chrome.storage.local")):console.warn("‚ö†Ô∏è Failed to download resume, but continuing with user data")}else console.warn("‚ö†Ô∏è Failed to get public URL for resume, but continuing with user data")}else console.log("‚ÑπÔ∏è No resume path found in user data");return c.data}catch(p){return console.error("‚ùå Error fetching user details:",p),null}}async function Lo(e){try{console.log("üì§ Sending failed field labels to API..."),console.log("Failed labels:",e);const o={};e.forEach(a=>{o[a]=""});const t=new FormData;t.append("user_data",JSON.stringify({additional_questions:o}));const s=await fetch(`${be}/v1/users/${Te}`,{method:"PUT",headers:{accept:"application/json","x-signature":ke,"x-user-id":Ie,"x-user-role":Ue},body:t});if(!s.ok)return console.error(`‚ùå Failed to send failed fields: ${s.status} - ${s.statusText}`),!1;const u=await s.json();return console.log("‚úÖ Failed field labels sent successfully"),console.log("Response:",u.metadata.message),!0}catch(o){return console.error("‚ùå Error sending failed fields:",o),!1}}const Pe={id:"",full_name:"",user_name:"",email:"",phone:"",role:"",status:"",first_name:"",middle_name:"",last_name:"",gender:"",age:0,date_of_birth:"",nationality:"",citizenship:"",alternate_phone:"",street_address:"",address_line_2:"",city:"",state:"",postal_code:"",country:"",location:"",preferred_language:"",timezone:"",preferred_locations:[],designation:"",secondary_designation:"",skills:"",secondary_skills:"",total_years_of_experience:0,summary:"",notice_period:"",current_location:"",willing_to_relocate:!1,english_proficiency:"",expected_salary:0,work_availability:[],available_hours:"",authorized_work_us:!1,authorized_work_uk:!1,authorized_work_canada:!1,visa_status:"",has_disability:!1,belongs_to_minority:!1,gender_identity:"",sexual_orientation:"",veteran_status:"",ethnicity:"",eeo_additional_notes:"",linkedin_link:"",github_link:"",portfolio_website:"",extra_links:{},image:"",resume:"",auth_provider:"",educations:[],experiences:[],meta:{}};function fo(e){if(!e)return!0;const o=["full_name","email","phone","first_name","last_name"];for(const t of o){const s=e[t];if(s&&s!==""&&s!==0)return!1}return!0}async function xo(){console.log("üîÑ Initializing Autofill Extension data.");try{const e=await chrome.storage.local.get("userData");if(e.userData&&!fo(e.userData)){console.log("‚úÖ User data already exists in storage. Skipping API call."),console.log("Available fields:",Object.keys(e.userData).length);return}console.log("üì° User data is empty. Fetching from API...");const o=await Se();if(!o){console.warn("‚ö†Ô∏è Failed to fetch user data from API. Using empty template."),await chrome.storage.local.set({userData:Pe});return}await chrome.storage.local.set({userData:o}),console.log("‚úÖ Autofill user data fetched from API and stored successfully"),console.log("Available fields:",Object.keys(o).length),console.log("Sample data:",{name:o.full_name,email:o.email,phone:o.phone})}catch(e){console.error("‚ùå Error initializing autofill data:",e),await chrome.storage.local.set({userData:Pe})}}function Ro(e,o,t){return e.action==="updateUserData"?(chrome.storage.local.set({userData:e.userData},()=>{t({success:!0})}),!0):e.action==="getUserData"?(chrome.storage.local.get("userData",async s=>{if(s.userData&&!fo(s.userData))t({userData:s.userData});else{console.log("üì° User data is empty. Fetching from API...");const u=await Se();u?(await chrome.storage.local.set({userData:u}),t({userData:u})):t({userData:Pe})}}),!0):e.action==="getResume"?(chrome.storage.local.get("resumeFile",s=>{t({resumeFile:s.resumeFile})}),!0):e.action==="refreshUserData"?(Se().then(s=>{s?chrome.storage.local.set({userData:s},()=>{console.log("‚úÖ User data refreshed from API"),t({success:!0,userData:s})}):(console.error("‚ùå Failed to refresh user data from API"),t({success:!1,error:"Failed to fetch from API"}))}),!0):e.action==="sendFailedFields"?(Lo(e.failedLabels).then(s=>{s?(console.log("‚úÖ Failed fields sent to API successfully"),t({success:!0})):(console.error("‚ùå Failed to send failed fields to API"),t({success:!1}))}),!0):!1}let qo="",z="";chrome.runtime.onInstalled.addListener(()=>{const o=chrome.runtime.getManifest().version;console.log("Extension successfully installed. Version:",o),xo()});console.log(z);chrome.runtime.onMessage.addListener((e,o,t)=>{if(Ro(e,o,t))return!0;if(e==="getLogData")t("message from background.ts");else{if(e.type==="GET_ACTIVE_TAB_URL")return(async()=>{var u;try{const a=await yo(t);console.log("main_url_base",a),(u=a.activeUrl)!=null&&u.includes("linkedin")&&(z=a.activeUrl,console.log("selected_tab_url_for_linkedin_if_we_want_another_save_and_add_from_here",z)),t({url:a.activeUrl})}catch(a){console.error("Error in handling active tab URL:",a),t({error:"Failed to retrieve active tab URL"})}})(),!0;e.action==="getCapturedUrls"?t(qo):e.action==="fetch_Linkedin_job_data"&&(console.log("fetch_Linkedin_job_data invoked",e),console.log("fetch_Linkedin_job_data_in_background",e.startPage,e.endPage),e.startPage&&e.endPage&&z.length>0&&ve.fetchAndProcessInBatches(e.startPage,e.endPage,z))}return!0});chrome.tabs.onUpdated.addListener((e,o,t)=>{console.log("Tab Data",t),o.url&&o.url.includes("linkedin.com/jobs/search")&&(z=o.url,console.log("Updated LinkedIn URL:",z),chrome.tabs.sendMessage(e,{action:"activateLinkedInComponent"}))});function go(e,o,t,s){console.log("processResponseMsg params",e,o,t,s);let{elements:u,metadata:a,paging:h}=e;console.log("elements: ",u),console.log("metadata: ",a),console.log("paging: ",h),u==null&&(u=e.data.messengerConversationsByCategory.elements);const p=[];let c=[],r=Date.now(),i=[],n=[],f=[],l=[],g=[],d=[],y=[],C=[],b=[],P=[],A=[],v=[];console.log("Main Messages console",C,c,p,u),u==null||u.forEach(_=>{var N,O,F,B,k,H,V,X,K,W,Y,Z,ee,te,oe,ne,se,ae,re,ie,ce,le,de,ue,pe,ge,fe,me,he,ye;if(console.log("Processing element:",_),_.withNonConnection!==!1)return;const m=_.sdkEntityUrn||_.entityUrn,T=(F=(O=(N=m==null?void 0:m.replace(/:/g,"%3A"))==null?void 0:N.replace(/\(/g,"%28"))==null?void 0:O.replace(/==\)/g,"%3D%3D%29"))==null?void 0:F.replace(/,/g,"%2C"),q="https://www.linkedin.com/voyager/api/voyagerMessagingGraphQL/graphql?queryId=messengerMessages.060b8b4d7dee63b8227028ebd88572a7&variables=(deliveredAt:"+r.toString()+",conversationUrn:"+T+",countBefore:20,countAfter:0)";n.push(T===void 0?"":q),i.push(T===void 0?"":T),(H=(k=(B=m==null?void 0:m.split("("))==null?void 0:B[1])==null?void 0:k.split(","))!=null&&H[0];const Q=((X=(V=_.events)==null?void 0:V[0])==null?void 0:X.originToken)||"";f.push(Q);const j=(Y=(W=(K=_.events)==null?void 0:K[0])==null?void 0:W.eventContent)==null?void 0:Y["com.linkedin.voyager.messaging.event.MessageEvent"],M=((Z=j==null?void 0:j.attributedBody)==null?void 0:Z.text)||"";l.push(M);const S=(ne=(oe=(te=(ee=_.events)==null?void 0:ee[0])==null?void 0:te.from)==null?void 0:oe["com.linkedin.voyager.messaging.MessagingMember"])==null?void 0:ne.miniProfile,J=S&&S.firstName&&S.lastName?`${S.firstName} ${S.lastName}`:"";g.push(J);const $=_.unreadCount??"";y.push($),b.push(_==null?void 0:_.read);const w=(re=(ae=(se=_.participants)==null?void 0:se[0])==null?void 0:ae["com.linkedin.voyager.messaging.MessagingMember"])==null?void 0:re.miniProfile,G=w&&w.firstName&&w.lastName?`${w.firstName} ${w.lastName}`:"";d.push(G),w!=null&&w.publicIdentifier;const D=(S==null?void 0:S.publicIdentifier)||"";P.push(D),_.lastActivityAt;const U=(ue=(de=(le=(ce=(ie=_.participants)==null?void 0:ie[0])==null?void 0:ce["com.linkedin.voyager.messaging.MessagingMember"])==null?void 0:le.miniProfile)==null?void 0:de.picture)==null?void 0:ue["com.linkedin.common.VectorImage"],E=U?U.rootUrl+((ge=(pe=U.artifacts)==null?void 0:pe[3])==null?void 0:ge.fileIdentifyingUrlPathSegment):"";A.push(E);const R="https://www.linkedin.com/in/"+((ye=(he=(me=(fe=_.participants)==null?void 0:fe[0])==null?void 0:me["com.linkedin.voyager.messaging.MessagingMember"])==null?void 0:he.miniProfile)==null?void 0:ye.publicIdentifier)||"";v.push(R)}),console.log("messages_to_share collected messages to store into database",o,P,{detail_urls:n,sdkEntityUrns:i,originTokens:f,texts:l,from_senders:g,is_reads:y,to_senders:d,main_message_read_status:b,profile_images:A,profile_urls:v}),s({result:"Linkedin_Initial_Chats Fetched",unique_identifiers:P,data:{detail_urls:n,sdkEntityUrns:i,originTokens:f,texts:l,from_senders:g,is_reads:y,to_senders:d,main_message_read_status:b,profile_pics:A,profile_urls:v}}),s({result:"fetch_linkedin_chats Action completed"})}const jo=async()=>{console.log(" Step 1 Entering into fetchLinkedinUserDetails");function e(){console.log("token2: ",chrome.cookies),chrome.cookies.get({url:"https://www.linkedin.com/*",name:"JSESSIONID"},o)}async function o(u){var p,c,r,i,n;if(!(u!=null&&u.value)){console.warn("Missing CSRF token in cookie");return}const a=u.value.replace(/"/g,""),h="https://www.linkedin.com/voyager/api/messaging/conversations?keyVersion=LEGACY_INBOX";try{const l=await(await fetch(h,{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json","csrf-token":a},credentials:"include"})).json();console.log("LinkedIn response:",l);const g=(c=(p=l==null?void 0:l.elements)==null?void 0:p[0])==null?void 0:c.sdkEntityUrn,d=(n=(i=(r=g==null?void 0:g.split("("))==null?void 0:r[1])==null?void 0:i.split(","))==null?void 0:n[0];if(console.log("sdkEntityUrn and linkedInId",g,d),!d){console.warn("LinkedIn ID not found in LinkedIn response");return}t(d,"")}catch(f){console.error("Error fetching LinkedIn data:",f)}}e();function t(u,a){console.log("requestStats1 invoked"),console.log("token2: ",chrome.cookies),chrome.cookies.get({url:"https://www.linkedin.com",name:"JSESSIONID"},h=>s(h,u,a))}function s(u,a,h){console.log("token1: ",u),console.log("UID Full: ",a),console.log("UID: ",a.split(":")[2]);let p=a.split(":");if(!u){console.log("token0: ");return}const c=u.value.replace(/"/g,"");let r="https://www.linkedin.com/voyager/api/identity/dash/profiles?decorationId=com.linkedin.voyager.dash.deco.identity.profile.WebTopCardCore-9&memberIdentity="+p[p.length-1]+"&q=memberIdentity";const i=new Request(r,{method:"GET",headers:new Headers({accept:"application/json","Content-Type":"application/json","csrf-token":c}),credentials:"include"});fetch(i).then(n=>n.json()).catch(n=>{console.log("EE",n)}).then(n=>{console.log("json test Final for Linkedin User Details: ",n);const f=n.elements[0].firstName,l=n.elements[0].lastName,g=f+" "+l;console.log("Full Name2: ",g),console.log("userid - ",h,{userName:g})})}};async function mo(e,o,t){var s,u,a,h,p,c,r,i,n,f,l,g,d;if(console.log("‚öôÔ∏è processResponseMsgDetail invoked"),console.log("üì® Input Payload:",{user_id:e,detail_url:o,sdkEntityUrn:t}),t!=null&&t.length)try{const y=t[0].replaceAll(":","%3A").replaceAll("(","%28").replaceAll("==)","%3D%3D%29").replaceAll(",","%2C"),C=`https://www.linkedin.com/voyager/api/voyagerMessagingGraphQL/graphql?queryId=messengerMessages.060b8b4d7dee63b8227028ebd88572a7&variables=(deliveredAt:${Date.now()},conversationUrn:${y},countBefore:20,countAfter:0)`,b=await _e("https://www.linkedin.com/*","JSESSIONID"),P=((s=b==null?void 0:b.value)==null?void 0:s.replace(/"/g,""))??"",A=new Request(C,{method:"GET",headers:new Headers({accept:"application/json","Content-Type":"application/json","csrf-token":P}),credentials:"include"}),_=await(await fetch(A)).json();console.log("Individual_image_json_data",_);const m=((a=(u=_==null?void 0:_.data)==null?void 0:u.messengerMessagesByAnchorTimestamp)==null?void 0:a.elements)??[],T=[],q=[],Q=[],j=[];m.forEach((w,G)=>{var D,U,E,R,N,O,F,B;console.log("For_Each_innerData",w,G);try{const k=((U=(D=w==null?void 0:w.sender)==null?void 0:D.participantType)==null?void 0:U.member)||"",H=`${(E=k==null?void 0:k.firstName)==null?void 0:E.text} ${(R=k==null?void 0:k.lastName)==null?void 0:R.text}`,V=((N=k==null?void 0:k.profilePicture)==null?void 0:N.rootUrl)+((B=(F=(O=k==null?void 0:k.profilePicture)==null?void 0:O.artifacts)==null?void 0:F[3])==null?void 0:B.fileIdentifyingUrlPathSegment)||"";T.push(w.deliveredAt),q.push(H),Q.push(w.body.text),j.push(V)}catch(k){console.warn(`‚ö†Ô∏è Message parsing failed at index ${G}:`,w,k)}});let M=null,S=null;const J=`https://www.linkedin.com/voyager/api/voyagerMessagingGraphQL/graphql?queryId=messengerSeenReceipts.2a64b8e3dacc77e4fe0737d1197c2e83&variables=(conversationUrn:${y})`;try{const w=new Request(J,{method:"GET",headers:new Headers({accept:"application/json","Content-Type":"application/json","csrf-token":P}),credentials:"include"}),D=await(await fetch(w)).json(),U=(p=(h=D==null?void 0:D.data)==null?void 0:h.messengerSeenReceiptsByConversation)==null?void 0:p.elements;if(U!=null&&U.length&&((c=U[0])!=null&&c.seenAt)){M=U[0].seenAt;const E=(n=(i=(r=U[0])==null?void 0:r.seenByParticipant)==null?void 0:i.participantType)==null?void 0:n.member,R=(f=E==null?void 0:E.profilePicture)==null?void 0:f.rootUrl,N=(d=(g=(l=E==null?void 0:E.profilePicture)==null?void 0:l.artifacts)==null?void 0:g[1])==null?void 0:d.fileIdentifyingUrlPathSegment;R&&N&&(S=R+N)}console.log("‚úÖ Success: seenAt:",M,"profilePic:",S)}catch(w){console.error("‚ùå Error fetching messengerSeenReceipts data:",w)}const $={detail_url:o,times:T,senders:q,texts:Q,profile_pics:j,seenAt:M,seenByProfilePic:S};return console.log("‚úÖ Returning main chats data:",$),$}catch(y){return console.error("‚ùå Error during LinkedIn chat fetch:",y),null}else return console.warn("‚ö†Ô∏è No sdkEntityUrns available."),null}function Mo(e,o,t,s){console.log("processResponseMsgViaSearch Payload: ",{json:e,user_id:o,token:t});const{data:u}=e,a=u.messengerConversationsBySearchCriteria.elements,h=u.messengerConversationsBySearchCriteria.metadata;console.log("processResponseMsgViaSearch",[],h,a);let c=[];const r=Date.now(),i=[],n=[],f=[],l=[],g=[],d=[],y=[],C=[],b=[],P=[],A=[],v=[],_=[];if(console.log(C,c,h),a==null||a.map(m=>{var D,U,E,R,N,O,F,B,k,H,V,X,K,W,Y,Z,ee,te,oe,ne,se,ae,re,ie,ce,le,de,ue,pe,ge,fe,me,he,ye,Ae,Ee,Ce,De,Ne,Le,xe,Re,qe,je,Me,$e,Oe,Fe,Be,Je,Ge,He,Ve,ze,Qe,Xe,Ke,We,Ye,Ze,et,tt,ot,nt,st,at,rt,it,ct,lt,dt,ut,pt,gt,ft,mt,ht,yt,_t,wt,vt,bt,kt,It,Ut,Tt,St,Pt,At,Et,Ct,Dt,Nt,Lt,xt,Rt,qt,jt,Mt,$t,Ot,Ft,Bt,Jt,Gt,Ht,Vt,zt,Qt,Xt,Kt,Wt,Yt,Zt,eo,to,oo,no,so,ao,ro,io,co,lo;let T=m.entityUrn,q=(R=(E=(U=(D=m.entityUrn)==null?void 0:D.replaceAll(":","%3A"))==null?void 0:U.replaceAll("(","%28"))==null?void 0:E.replaceAll("==)","%3D%3D%29"))==null?void 0:R.replaceAll(",","%2C"),Q="https://www.linkedin.com/voyager/api/voyagerMessagingGraphQL/graphql?queryId=messengerMessages.060b8b4d7dee63b8227028ebd88572a7&variables=(deliveredAt:"+r.toString()+",conversationUrn:"+q+",countBefore:20,countAfter:0)";q===void 0?n.push(""):n.push(Q),q===void 0?i.push(""):i.push(q),(F=(O=(N=T.split("("))==null?void 0:N[1])==null?void 0:O.split(","))==null||F[0];let j=(V=(H=(k=(B=m.messages)==null?void 0:B.elements)==null?void 0:k[0])==null?void 0:H.body)==null?void 0:V.text,M=(Y=(W=(K=(X=m.messages)==null?void 0:X.elements)==null?void 0:K[0])==null?void 0:W.sender)==null?void 0:Y.hostIdentityUrn,S=(ee=(Z=m.conversationParticipants)==null?void 0:Z[0])==null?void 0:ee.hostIdentityUrn;if(M===o)if(M==S){let L=((ae=(se=(ne=(oe=(te=m.conversationParticipants)==null?void 0:te[1])==null?void 0:oe.participantType)==null?void 0:ne.member)==null?void 0:se.firstName)==null?void 0:ae.text)+" "+((de=(le=(ce=(ie=(re=m.conversationParticipants)==null?void 0:re[1])==null?void 0:ie.participantType)==null?void 0:ce.member)==null?void 0:le.lastName)==null?void 0:de.text);(fe=(ge=(pe=(ue=m.conversationParticipants)==null?void 0:ue[1])==null?void 0:pe.participantType)==null?void 0:ge.member)==null||fe.profileUrl,L===void 0?d.push(""):d.push(L);let x=((Ee=(Ae=(ye=(he=(me=m.conversationParticipants)==null?void 0:me[0])==null?void 0:he.participantType)==null?void 0:ye.member)==null?void 0:Ae.firstName)==null?void 0:Ee.text)+" "+((xe=(Le=(Ne=(De=(Ce=m.conversationParticipants)==null?void 0:Ce[0])==null?void 0:De.participantType)==null?void 0:Ne.member)==null?void 0:Le.lastName)==null?void 0:xe.text);x===void 0?g.push(""):g.push(x)}else{let L=(($e=(Me=(je=(qe=(Re=m.conversationParticipants)==null?void 0:Re[0])==null?void 0:qe.participantType)==null?void 0:je.member)==null?void 0:Me.firstName)==null?void 0:$e.text)+" "+((Ge=(Je=(Be=(Fe=(Oe=m.conversationParticipants)==null?void 0:Oe[0])==null?void 0:Fe.participantType)==null?void 0:Be.member)==null?void 0:Je.lastName)==null?void 0:Ge.text);(Qe=(ze=(Ve=(He=m.conversationParticipants)==null?void 0:He[0])==null?void 0:Ve.participantType)==null?void 0:ze.member)==null||Qe.profileUrl,L===void 0?d.push(""):d.push(L);let x=((Ze=(Ye=(We=(Ke=(Xe=m.conversationParticipants)==null?void 0:Xe[1])==null?void 0:Ke.participantType)==null?void 0:We.member)==null?void 0:Ye.firstName)==null?void 0:Ze.text)+" "+((st=(nt=(ot=(tt=(et=m.conversationParticipants)==null?void 0:et[1])==null?void 0:tt.participantType)==null?void 0:ot.member)==null?void 0:nt.lastName)==null?void 0:st.text);x===void 0?g.push(""):g.push(x)}else if(M==S){let L=((lt=(ct=(it=(rt=(at=m.conversationParticipants)==null?void 0:at[0])==null?void 0:rt.participantType)==null?void 0:it.member)==null?void 0:ct.firstName)==null?void 0:lt.text)+" "+((ft=(gt=(pt=(ut=(dt=m.conversationParticipants)==null?void 0:dt[0])==null?void 0:ut.participantType)==null?void 0:pt.member)==null?void 0:gt.lastName)==null?void 0:ft.text);(_t=(yt=(ht=(mt=m.conversationParticipants)==null?void 0:mt[0])==null?void 0:ht.participantType)==null?void 0:yt.member)==null||_t.profileUrl,L===void 0?d.push(""):d.push(L);let x=((It=(kt=(bt=(vt=(wt=m.conversationParticipants)==null?void 0:wt[0])==null?void 0:vt.participantType)==null?void 0:bt.member)==null?void 0:kt.firstName)==null?void 0:It.text)+" "+((At=(Pt=(St=(Tt=(Ut=m.conversationParticipants)==null?void 0:Ut[0])==null?void 0:Tt.participantType)==null?void 0:St.member)==null?void 0:Pt.lastName)==null?void 0:At.text);x===void 0?g.push(""):g.push(x)}else{let L=((Lt=(Nt=(Dt=(Ct=(Et=m.conversationParticipants)==null?void 0:Et[1])==null?void 0:Ct.participantType)==null?void 0:Dt.member)==null?void 0:Nt.firstName)==null?void 0:Lt.text)+" "+((Mt=(jt=(qt=(Rt=(xt=m.conversationParticipants)==null?void 0:xt[1])==null?void 0:Rt.participantType)==null?void 0:qt.member)==null?void 0:jt.lastName)==null?void 0:Mt.text);(Bt=(Ft=(Ot=($t=m.conversationParticipants)==null?void 0:$t[0])==null?void 0:Ot.participantType)==null?void 0:Ft.member)==null||Bt.profileUrl,L===void 0?d.push(""):d.push(L);let x=((zt=(Vt=(Ht=(Gt=(Jt=m.conversationParticipants)==null?void 0:Jt[1])==null?void 0:Gt.participantType)==null?void 0:Ht.member)==null?void 0:Vt.firstName)==null?void 0:zt.text)+" "+((Yt=(Wt=(Kt=(Xt=(Qt=m.conversationParticipants)==null?void 0:Qt[1])==null?void 0:Xt.participantType)==null?void 0:Kt.member)==null?void 0:Wt.lastName)==null?void 0:Yt.text);x===void 0?g.push(""):g.push(x)}j===void 0?l.push(""):l.push(j);let J=m.read;b.push(m==null?void 0:m.read),J===void 0?J.push(""):y.push(J),m.lastActivityAt===void 0?P.push(""):P.push(m.lastActivityAt);const $=(no=(oo=(to=(eo=(Zt=m.participants)==null?void 0:Zt[0])==null?void 0:eo["com.linkedin.voyager.messaging.MessagingMember"])==null?void 0:to.miniProfile)==null?void 0:oo.picture)==null?void 0:no["com.linkedin.common.VectorImage"],w=$?$.rootUrl+((ao=(so=$.artifacts)==null?void 0:so[3])==null?void 0:ao.fileIdentifyingUrlPathSegment):"";v.push(w);const G="https://www.linkedin.com/in/"+((lo=(co=(io=(ro=m.participants)==null?void 0:ro[0])==null?void 0:io["com.linkedin.voyager.messaging.MessagingMember"])==null?void 0:co.miniProfile)==null?void 0:lo.publicIdentifier)||"";return _.push(G),null}),console.log("messages_to_share: ",o,A,{detail_urls:n,sdkEntityUrns:i,originTokens:f,texts:l,from_senders:g,is_reads:y,to_senders:d}),s({result:"Linkedin_Initial_Chats Fetched",unique_identifiers:A,data:{detail_urls:n,sdkEntityUrns:i,originTokens:f,texts:l,from_senders:g,is_reads:y,to_senders:d,main_message_read_status:b,profile_pics:v,profile_urls:_}}),n!==void 0){const m=new Request(n==null?void 0:n[0],{method:"GET",headers:new Headers({accept:"application/json","Content-Type":"application/json","csrf-token":t}),credentials:"include"});fetch(m).then(T=>T.json()).then(T=>mo(T,o,n==null?void 0:n[0])).then(T=>{console.log("Fetched individual chat details:",{individualChatDetails:T,user_id:o,detail_urls:n})})}}async function Fo(){var e,o;try{const t="https://www.linkedin.com/voyager/api/me",s=await _e("https://www.linkedin.com","JSESSIONID");if(!s)return console.error("JSESSIONID cookie not found"),null;const u=s.value.replace(/"/g,""),a=await fetch(t,{headers:{"csrf-token":u,accept:"application/json"},credentials:"include"});if(!a.ok)throw new Error(`HTTP error: ${a.status}`);const h=await a.json();console.log("This is the profileData",h);const p=(e=h==null?void 0:h.miniProfile)==null?void 0:e.entityUrn;console.log("This is the userUrn",p);const c=(o=p==null?void 0:p.split(":"))==null?void 0:o[3];return c?(console.log("Extracted LinkedIn User ID:",c),c):(console.error("Profile URN not found in:",h),null)}catch(t){return console.error("API request failed:",t.message),null}}async function $o(e){var s,u,a,h,p;const o=await _e("https://www.linkedin.com","JSESSIONID");if(!o){console.error("JSESSIONID cookie not found.");return}const t=o.value.replace(/"/g,"");try{const c=await fetch("https://www.linkedin.com/voyager/api/graphql?includeWebMetadata=true&variables=()&queryId=voyagerRelationshipsDashCustomInviteComposeView.609650a05977a8ce1f34de667ea30a65",{method:"GET",credentials:"include",headers:{"csrf-token":t,accept:"application/vnd.linkedin.normalized+json+2.1","x-restli-protocol-version":"2.0.0"}});if(!c.ok)throw new Error(`HTTP error ${c.status}`);const r=await c.json();console.log("getLikedinRemainingConnectRequestCountandMessage response data:",r);const i=(p=(h=(a=(u=(s=r==null?void 0:r.data)==null?void 0:s.data)==null?void 0:u.relationshipsDashCustomInviteComposeViewByInviter)==null?void 0:a.elements[0])==null?void 0:h.remainingCreditsMessage)==null?void 0:p.text;console.log("getLikedinRemainingConnectRequestCountandMessage",r),e({type:"LINKEDIN_CONNECTTION_REQUEST_COUNT_SUCCESS_DATA",payload:i})}catch(c){console.error("Error fetching LinkedIn GraphQL data:",c),e({type:"LINKEDIN_CONNECTTION_REQUEST_COUNT_ERROR_DATA",error:String(c)})}}chrome.runtime.onMessageExternal.addListener(async(e,o,t)=>{var s,u;if(console.log("Received external message:",e,"from",o),e.action==="check_login_status")return await Po()?(console.log("User is logged in"),t({isLoggedIn:!0})):(console.log("User is NOT logged in"),t({isLoggedIn:!1})),!0;if(e.action==="check_linkedin_connection")return console.log("Received message from React app for check_linkedin_connection:",e),t({status:"success",message:"Linkedin connected successfully"}),!0;if(e.action==="check_linkedin_and_get_linkedin_active_user_details"){let a=function(){console.log("token2: ",chrome.cookies),chrome.cookies.get({url:"https://www.linkedin.com/*",name:"JSESSIONID"},c)},h=function(r){console.log("token2: ",chrome.cookies),chrome.cookies.get({url:"https://www.linkedin.com",name:"JSESSIONID"},i=>p(i,r))},p=function(r,i){console.log("token1: ",r),console.log("UID Full: ",i),console.log("UID: ",i.split(":")[2]);let n=i.split(":");if(!r){console.log("token0: ");return}const f=r.value.replace(/"/g,"");let l="https://www.linkedin.com/voyager/api/identity/dash/profiles?decorationId=com.linkedin.voyager.dash.deco.identity.profile.WebTopCardCore-9&memberIdentity="+n[n.length-1]+"&q=memberIdentity";const g=new Request(l,{method:"GET",headers:new Headers({accept:"application/json","Content-Type":"application/json","csrf-token":f}),credentials:"include"});fetch(g).then(d=>d.json()).catch(d=>{console.log("E",d),t({msg:"please login to your linkedin account"})}).then(d=>{console.log("json test Final for linkedin user details: ",d);const y=d.elements[0].firstName,C=d.elements[0].lastName,b=y+" "+C;console.log("Full Name2:",b),(d==null?void 0:d.status)===401?t({msg:"please login to your linkedin account"}):t({msg:"linkedin_user_details_fetched_successfully",id:i,fullName:b,user_details:d.elements[0]})})};console.log("ENTERED IN CHECK LINKEDIN");async function c(r){if(await jo(),console.log("token1: ",r),!r){console.log("token0: ");return}const i=r.value.replace(/"/g,"");console.log("Token: ",i);let n="https://www.linkedin.com/voyager/api/messaging/conversations?keyVersion=LEGACY_INBOX";const f=new Request(n,{method:"GET",headers:new Headers({accept:"application/json","Content-Type":"application/json","csrf-token":i}),credentials:"include"});console.log("Request passed",f),fetch(f).then(l=>{if(!l.ok)throw t({error_message:"Please ensure you're logged into LinkedIn. If you're already logged in but still facing issues, try logging in using your email and password instead of OAuth."}),new Error("Network response was not ok");return l.json()}).catch(l=>{console.log("Error - ",l),t({msg:"Please login to your LinkedIn account"})}).then(l=>{var d,y,C,b,P,A;console.log("json test:",l);let g=(A=(P=(b=(C=(y=(d=l==null?void 0:l.elements)==null?void 0:d[0])==null?void 0:y.sdkEntityUrn)==null?void 0:C.split("("))==null?void 0:b[1])==null?void 0:P.split(","))==null?void 0:A[0];console.log("linkedin_id",g),h(g),(l==null?void 0:l.status)===401&&t({msg:"Please login to your LinkedIn account"})})}a()}else if(e.action=="fetch_linkedin_search_results"){let a=function(){console.log("token2: ",chrome.cookies),chrome.cookies.get({url:"https://www.linkedin.com",name:"JSESSIONID"},h)},h=function(r){if(!r){console.log("token0: ");return}let n=`https://www.linkedin.com/voyager/api/voyagerMessagingGraphQL/graphql?queryId=messengerConversations.dac8c7f1824a84031125226192309c91&variables=(categories:List(INBOX,SPAM,ARCHIVE),count:20,firstDegreeConnections:false,mailboxUrn:${encodeURIComponent(c)},keywords:`+p+")",f="https://www.linkedin.com/voyager/api/graphql?variables=(keyword:"+p+",types:List(CONNECTIONS))&&queryId=voyagerMessagingDashMessagingTypeahead.8100af826d4cb2f0f75ab84b4ea40b80";const l=r.value.replace(/"/g,"");if(p!==""){console.log("üîç Query detected:",p),console.log("üì° Fetching message conversations using search...");const g=new Request(n,{method:"GET",headers:new Headers({accept:"application/json","Content-Type":"application/json","csrf-token":l}),credentials:"include"});console.log("üì§ Sending request to:",n),fetch(g).then(y=>(console.log("‚úÖ Received response for message_conversations:",y),y.json())).then(y=>{console.log("üì® JSON received for message_conversations:",y),Mo(y,c,l,t)}).catch(y=>{console.error("‚ùå Error fetching message_conversations:",y)});const d=new Request(f,{method:"GET",headers:new Headers({accept:"application/json","Content-Type":"application/json","csrf-token":l}),credentials:"include"});console.log("üì§ Sending request to:",f),fetch(d).then(y=>(console.log("‚úÖ Received response for message_connections:",y),y.json())).then(y=>{console.log("üì® JSON received for message_connections:",y)}).catch(y=>{console.error("‚ùå Error fetching message_connections:",y)})}else{console.log("üîï No search query provided. Fetching default conversation list...");const g="https://www.linkedin.com/voyager/api/messaging/conversations?keyVersion=LEGACY_INBOX",d=new Request(g,{method:"GET",headers:new Headers({accept:"application/json","Content-Type":"application/json","csrf-token":l}),credentials:"include"});console.log("üì§ Sending default conversations request to:",g),fetch(d).then(y=>(console.log("‚úÖ Received response for default conversations:",y),y.json())).then(y=>{console.log("üì® JSON received for default conversations:",y),go(y,c,l,t)}).catch(y=>{console.error("‚ùå Error fetching default conversations:",y)})}},p=(s=e==null?void 0:e.payload)==null?void 0:s.query,c=(u=e==null?void 0:e.payload)==null?void 0:u.user_id;console.log("fetch_linkedin_chats Action started",{query:p,user_id:c}),a()}else if(e.action==="fetch_linkedin_chat_details"){const{detail_urls:a,user_id:h,sdkEntityUrns:p}=e==null?void 0:e.payload;console.log("Message_payload_for_Individual_chats_now_received",{detail_urls:a,user_id:h,sdkEntityUrns:p}),mo(h,a,p).then(c=>{c?(console.log("‚úÖ Got chats, now send to web app:",c),t({status:"success",message:"Chat data fetched successfully",data:c})):console.warn("‚ùå No chat data fetched.")})}else if(e.action==="send_linkedin_message"){let a=function(){console.log("token2: ",chrome.cookies),chrome.cookies.get({url:"https://www.linkedin.com",name:"JSESSIONID"},h)},h=function(f){var A;if(console.log("token1: ",f),!f){console.log("token0: ");return}const l=f.value.replace(/"/g,"");let g=[];for(let v=0;v<16;v++)g.push(Math.floor(Math.random()*256));let d=new Uint8Array(g),y=Array.from(d,v=>String.fromCharCode(v)).join(""),C=(A=So())==null?void 0:A.toString(),b={};n==0?(console.log("Sending message as new connection"),b={dedupeByClientGeneratedToken:!1,mailboxUrn:r,message:{body:{text:p,attributes:[]},originToken:C,renderContentUnions:[],conversationUrn:c},trackingId:y}):(console.log("Sending message as existing connection"),b={dedupeByClientGeneratedToken:!1,mailboxUrn:r,message:{body:{text:p,attributes:[]},originToken:"7b3d2ec9-fb3d-4192-8f2a-0962997d3e44",renderContentUnions:[]},trackingId:y,hostRecipientUrns:[c]});const P=new Request("https://www.linkedin.com/voyager/api/voyagerMessagingDashMessengerMessages?action=createMessage",{method:"POST",headers:new Headers({accept:"application/json","Content-Type":"application/json","csrf-token":l}),credentials:"include",body:JSON.stringify(b)});fetch(P).then(v=>v.json()).catch(v=>{console.log(v),t({msg:"pls open your linkedin"})}).then(v=>{if(console.log("json inside1: ",v),(v==null?void 0:v.status)===401)t({msg:"pls open your linkedin"});else{const _=new Request("https://www.linkedin.com/voyager/api/messaging/conversations?keyVersion=LEGACY_INBOX",{method:"GET",headers:new Headers({accept:"application/json","Content-Type":"application/json","csrf-token":l}),credentials:"include"});fetch(_).then(m=>m.json()).then(m=>go(m,i,l,t)),t({msg:"success"})}})};const{text:p,conversation_urn:c,mailbox_urn:r,user_id:i,is_connection:n}=e.payload;console.log("Send Linkedin Messages payload"),a()}else if(e.action=="linkedinConnections"){let a=function(){console.log("token2: ",chrome.cookies),chrome.cookies.get({url:"https://www.linkedin.com",name:"JSESSIONID"},h)},h=function(p){if(!p){console.log("token0: ");return}let c="https://www.linkedin.com/voyager/api/voyagerMessagingGraphQL/graphql?queryId=messengerConversations.dac8c7f1824a84031125226192309c91&variables=(categories:List(INBOX,SPAM,ARCHIVE),count:20,firstDegreeConnections:false,mailboxUrn:urn%3Ali%3Afsd_profile%3AACoAAASg-TsBz84jyIjse5R8e_RqGn6LWCq4KZA)",r="https://www.linkedin.com/voyager/api/graphql?variables=(keyword:b,types:List(CONNECTIONS))&&queryId=voyagerMessagingDashMessagingTypeahead.8100af826d4cb2f0f75ab84b4ea40b80",i="https://www.linkedin.com/voyager/api/voyagerMessagingGraphQL/graphql?queryId=messengerConversations.ec20d615b99f18f7489617a00360e62c&variables=(category:PRIMARY_INBOX,count:20,mailboxUrn:urn%3Ali%3Afsd_profile%3AACoAAASg-TsBz84jyIjse5R8e_RqGn6LWCq4KZA,lastUpdatedBefore:1684827456000)";const n=p.value.replace(/"/g,"");let f=new Request(c,{method:"GET",headers:new Headers({accept:"application/json","Content-Type":"application/json","csrf-token":n}),credentials:"include"});fetch(f).then(d=>d.json()).then(d=>console.log("message conversations: ",d));let l=new Request(r,{method:"GET",headers:new Headers({accept:"application/json","Content-Type":"application/json","csrf-token":n}),credentials:"include"});fetch(l).then(d=>d.json()).then(d=>console.log("connections: ",d));let g=new Request(i,{method:"GET",headers:new Headers({accept:"application/json","Content-Type":"application/json","csrf-token":n}),credentials:"include"});fetch(g).then(d=>d.json()).then(d=>console.log("paginations: ",d))};a()}else{if(e.action==="send_linkedin_connect")return(async()=>{try{const{message:a,urls:h,candidate_ids:p}=e.payload;console.log("Payload received for LinkedIn Connect:",{mainMessage:a,urls:h,candidate_ids:p});const c=h.map((n,f)=>({url:n,candidateId:p[f]})),r=await Eo(),i={total:c.length,success:0,failed:0,failures:[]};for(const n of c)try{await new Promise(l=>setTimeout(l,3e3+Math.random()*2e3));const f=await Ao(n.url,a,r);console.log(f),i.success++}catch(f){console.error(`Error processing ${n.url}:`,f.message),i.failed++,i.failures.push({candidate:n,error:f.message})}console.log("--- LinkedIn Connect Process Finished ---",i),t({status:"success",data:i})}catch(a){console.error("A critical error occurred:",a.message),t({status:"error",message:a.message})}})(),!0;if(e.action==="check_linkedin_remaining_connect_message")return console.log("Received message:",e),$o(t),!0}return!0});export{Fo as extractLinkedinUserId,jo as fetchLinkedinUserDetails};
